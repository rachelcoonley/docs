<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Scheduling Services in Cattle Environments</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Documentation for Rancher">
    <link href="/docs/favicon.png" rel="shortcut icon" type="image/png" sizes="16x16">
    <link href="/docs/css/syntax.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/vendor/font-awesome/css/font-awesome.min.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/vendor/lato/lato.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/css/lacsso.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/css/slicknav.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/css/rancher-docs.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
  </head>
  <body class="bg-default">
    <div class="row body">
      <header id="header" class="section">
        <nav class="row" role="navigation">
          <div class="col span-3">
          <a class="navbar-brand" href="/"><img src="/docs/img/rancher-logo-nopadding.svg" width="200px" style="padding-left: 20px" /></a>
          </div>

          <div class="col span-5 offset-3">
            <!--Start Google Search-->
            <div class="gcse-search" id="google-search"></div>
            <script>
              var match = window.location.pathname.match(/\/rancher\/([^\/]+)/);
              if ( match ) {
                document.getElementById('google-search').setAttribute('data-defaultToRefinement', match[1]);
              }

              (function() {
                var cx = '007896692384436596364:60akf3bfmxm';
                var gcse = document.createElement('script');
                gcse.type = 'text/javascript';
                gcse.async = true;
                gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(gcse, s);
              })();
            </script>
            <!--End Google Search-->
          </div>
        </nav>
      </header>
      <div class="col span-3 mt-0 mr-0 sidebar">

<ul id="menu">
    <li><a href="/docs/rancher/v1.6/en/">Overview</a></li>
    <li><a href="/docs/rancher/v1.6/en/quick-start-guide/">Quick Start Guide</a></li>
    <li>
        <a href="#">Installing Rancher<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/">Rancher Server</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#requirements">Rancher Server Requirements</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#rancher-server-tags">Rancher Server Tags</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#single-container">Launching Rancher Server</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#multi-nodes">Setting up HA</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#requirements-for-ha">HA Requirements</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#single-container-external-database">Using an External DB</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#single-container-bind-mount">Bind Mounted MySQL Volume</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#elb">Using an ELB in AWS</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#ldap">Using LDAP/AD with TLS</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#http-proxy">Behind an HTTP Proxy</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/selinux/">SELinux Requirements for RHEL/CentOS</a></li>
          <li>
               <a href="#">Basic SSL Configuration<i class="pull-right fa fa-angle-down"></i></a>
               <ul>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#requirements">Requirements</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#example-nginx-configuration">Example NGINX Configuration</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#example-apache-configuration">Example Apache Configuration</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#example-haproxy-configuration">Example HAProxy Configuration</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#example-f5-big-ip-configuration">Example F5 BIG-IP Configuration</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#elb">Using an ELB in AWS with SSL</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#using-self-signed-certs-beta">Using Self Signed Certs</a></li>
               </ul>
          </li>
          <li>
               <a href="#">No Internet Access<i class="pull-right fa fa-angle-down"></i></a>
               <ul>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/no-internet-access/#using-a-private-registry">Using a Private Registry</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/no-internet-access/#using-an-http-proxy">Using an HTTP Proxy</a></li>
               </ul>
          </li>
        </ul>
    </li>
    <li>
         <a href="#">Upgrading Rancher<i class="pull-right fa fa-angle-down"></i></a>
         <ul>
           <li><a href="/docs/rancher/v1.6/en/upgrading/">Upgrading Rancher</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#rancher-server-tags">Rancher Server Tags</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#infrastructure-services">Upgrading Infrastructure Services</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#multi-nodes">Upgrading Rancher HA Setup</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#single-container-external-database">Using an external DB</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#single-container-bind-mount">Bind Mounted MySQL Volume</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#rancher-server-with-no-internet-access">No Internet Access</a></li>
        </ul>
     </li>
    <li>
         <a href="#">Rancher Configuration<i class="pull-right fa fa-angle-down"></i></a>
         <ul>
           <li>
                <a href="#">Access Control Providers<i class="pull-right fa fa-angle-down"></i></a>
                <ul>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#active-directory">Active Directory</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#azure-ad">Azure AD</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#github">Github</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#local-authentication">Local Authentication</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#openldap">OpenLDAP</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#shibboleth">Shibboleth/SAML</a></li>
                </ul>
          </li>
          <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#site-access">Rancher Site Access</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#restricting-concurrent-sessions">Restricting Concurrent Sessions</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/accounts/">Accounts</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/settings/#host-registration">Host Registration</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/settings/#catalog">Enabling Catalogs</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/machine-drivers/">Machine Drivers</a></li>
        </ul>
    </li>
    <li>
          <a href="#">Environments<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
            <li><a href="/docs/rancher/v1.6/en/environments/">Managing Environments</a></li>
            <li><a href="/docs/rancher/v1.6/en/environments/#what-is-an-environment-template">Environment Templates</a></li>
            <li><a href="/docs/rancher/v1.6/en/environments/#membership-roles">Roles in an Environment</a></li>
          </ul>
    </li>
    <li>
        <a href="#">Hosts<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
          <li><a href="/docs/rancher/v1.6/en/hosts/">Getting Started with Hosts</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#supported-docker-versions">Supported Docker Versions</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#host-labels">Adding Host Labels</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#scheduler-ips">Adding Scheduler IPs</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#hosts-behind-an-http-proxy">Behind an HTTP Proxy</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/custom/">Adding Custom Hosts</a></li>
          <li>
              <a href="#">Adding Cloud Provided Hosts<i class="pull-right fa fa-angle-down"></i></a>
              <ul>
                <li><a href="/docs/rancher/v1.6/en/hosts/amazon/">Adding Amazon EC2 Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/azure/">Adding Azure Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/digitalocean/">Adding DigitalOcean Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/exoscale/">Adding Exoscale Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/packet/">Adding Packet Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/rackspace/">Adding Rackspace Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/other/">Adding Hosts from Other Cloud Providers</a></li>
              </ul>
          </li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#accessing-hosts-from-the-cloud-providers">Accessing Cloud Provided Hosts</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#removing-hosts">Removing Hosts</a></li>
        </ul>
    </li>
    <li>
      <a href="#">Registries<i class="pull-right fa fa-angle-down"></i></a>
      <ul>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/">Adding Private Registries</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#insecure-registries">Insecure Registries</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#self-signed-certificates">Self Signed Certificates</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#using-amazons-ecr-registry">Using Amazon's ECR</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#using-google-container-registry">Using Google Container Registry</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#changing-the-default-registry">Changing the Default Registry</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#limiting-which-registries-can-be-used">Limiting Registries</a></li>
      </ul>
    </li>
    <li><a href="/docs/rancher/v1.6/en/environments/certificates/">Certificates</a></li>
    <li>
      <a href="#">Infrastructure Services<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/">Infrastructure Services</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/networking/">Networking</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/network-policy/">Network Policies</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/load-balancer">Load Balancer</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/dns-service/">DNS Service</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/metadata-service/">Metadata Service</a></li>
              <li>
                  <a href="#">Persistent Storage Service<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/storage-service/">Persistent Storage Service</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/storage-service/rancher-nfs/">Rancher NFS</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/storage-service/rancher-ebs/">Rancher EBS</a></li>
                  </ul>
              </li>
              <li>
                  <a href="#">External Scheduler<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/">External Scheduler</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/#multiple-ips">Scheduling against multiple IPs</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/#resource-constraints">Scheduling with Resource Constraints</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/#restrict-services-on-host">Scheduling only Specific Services on a Host</a></li>
                  </ul>
              </li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/audit-log/">Audit Logging</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/service-accounts/">Service Accounts</a></li>
           </ul>
    </li>
    <li>
          <a href="#">Cattle<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
                <li><a href="/docs/rancher/v1.6/en/cattle/stacks/">Stacks</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/adding-services/">Services</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/volumes/">Volumes</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/">Load Balancers</a></li>
                <li>
                    <a href="#">Load Balancer Options in the UI<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#adding-a-load-balancer-in-the-ui">Adding Load Balancers</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#service-rule">Targeting Specific Services</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#selector-rule">Targeting Services based on Selectors</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#ssl-termination">SSL Termination</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#stickiness-policy-for-load-balancers">Stickiness Policy</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#custom-haproxy-configuration">Custom HAProxy Configuration</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#labelsscheduling-load-balancers">Labels and Scheduling</a></li>
                      </ul>
                </li>
                <li>
                    <a href="#">Load Balancer Options with CLI and Compose<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#adding-a-load-balancer-with-rancher-compose">Adding Load Balancers</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#source-ports">Defining Source Ports</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#port-rules">Port Rules</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#certificates">Certificates</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#custom-configuration">Custom HAProxy Configuration</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#stickiness-policy">Stickiness Policy</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#load-balancer-example-l7">Example of L7 Load Balancer</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#internal-load-balancer-example">Example of Internal Load Balancer</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#ssl-termination-example">Example of SSL Termination with a Load Balancer</a></li>
                      </ul>
                </li>
                <li><a href="/docs/rancher/v1.6/en/cattle/adding-external-services/">External Services</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/adding-service-alias/">Service Alias</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/health-checks/">Health Checks</a></li>
                <li>
                    <a href="#">Scheduling Services<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/en/cattle/scheduling/">Scheduling</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/scheduling/#scheduling-options-in-the-ui">Scheduling in the UI</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/scheduling/#adding-labels-in-rancher-compose">Scheduling in Rancher Compose</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/scheduling/#table-of-scheduling-labels">Table of Scheduling Labels</a></li>
                    </ul>
                </li>
                <li><a href="/docs/rancher/v1.6/en/cattle/upgrading/">Upgrading Services</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/internal-dns-service/">Internal DNS Service in Cattle Environments</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/external-dns-service/">External DNS Service</a></li>
                <li>
                    <a href="#">Rancher-Compose<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/en/cattle/rancher-compose/">Rancher Compose</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/rancher-compose/commands/">Commands and Options</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/rancher-compose/environment-interpolation/">Environment Interpolation</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/rancher-compose/build/">Building with AWS S3</a></li>
                    </ul>
                </li>
                <li><a href="/docs/rancher/v1.6/en/cattle/secrets/">Secrets - Experimental</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/webhook-service/">Webhooks</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/labels/">Labels in Cattle</a></li>
          </ul>
    </li>
    <li>
          <a href="#">Kubernetes<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/">Launching Kubernetes</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/resiliency-planes/">Resiliency Planes</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/providers/">Cloud Providers</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/private-registry/">Private Registry</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/rbac/">RBAC</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/disaster-recovery/">Disaster Recovery</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/backups/">Backups</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/storage/">Persistent Storage</a></li>
              <li>
                  <a href="#">Add-ons Support<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/addons/">Add-ons Support</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/addons/#helm">Helm</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/addons/#skydns">SkyDNS</a></li>
                  </ul>
              </li>
              <li>
                  <a href="#">Ingress Support and Options<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/">Ingress Support</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#host-based-routing">Host Based Routing</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#path-based-routing">Path Based Routing</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#scale-and-other-port">Multiple Load Balancers and Selecting Ports</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#tls">Using TLS</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#blocking-http">Blocking HTTP</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#custom-haproxy">Custom HAProxy</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#scheduled-globally">Scheduling on all Hosts</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#host-scheduling">Scheduling on a specific Host</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#only-local">Targeting Only Containers on the Same Host</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#prefer-local">Prioritizing Containers on the Same Host</a></li>
                  </ul>
              </li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/upgrading/">Upgrading Kubernetes</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/deleting/">Deleting Kubernetes</a></li>

          </ul>
    </li>
    <li><a href="/docs/rancher/v1.6/en/mesos/">Mesos</a></li>
    <li><a href="/docs/rancher/v1.6/en/swarm/">Swarm - Experimental </a></li>
    <li><a href="/docs/rancher/v1.6/en/windows/">Windows - Experimental</a></li>
    <li><a href="/docs/rancher/v1.6/en/native-docker/">Using Native Docker CLI</a></li>
    <li>
            <a href="#">Rancher Catalog<i class="pull-right fa fa-angle-down"></i></a>
            <ul>
                <li><a href="/docs/rancher/v1.6/en/catalog/">Catalog</a></li>
                <li><a href="/docs/rancher/v1.6/en/catalog/private-catalog/">Creating Private Catalogs</a></li>
            </ul>
        </li>
    <li><a href="#">Rancher CLI<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
            <li><a href="/docs/rancher/v1.6/en/cli/">Rancher CLI</a></li>
            <li><a href="/docs/rancher/v1.6/en/cli/commands/">Commands and Options</a></li>
            <li><a href="/docs/rancher/v1.6/en/cli/variable-interpolation/">Variable Interpolation</a></li>
        </ul>
    </li>
    <li><a href="/docs/rancher/v1.6/en/api/v2-beta/">API Documentation</a></li>
    <li><a href="/docs/rancher/v1.6/en/contributing/">Contributing to Rancher</a></li>
    <li>
        <a href="#">FAQs<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
            <li><a href="/docs/rancher/v1.6/en/faqs/server/">FAQs about Rancher Server</a></li>
            <li><a href="/docs/rancher/v1.6/en/faqs/agents/">FAQs about Rancher Agents/Hosts</a></li>
            <li><a href="/docs/rancher/v1.6/en/faqs/troubleshooting/">Troubleshooting FAQS</a></li>
        </ul>
    </li>
    <li>
        <a href="#">Docs Archive<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
            <li><a href="/docs/rancher/v1.5/en/">Rancher v1.5</a></li>
            <li><a href="/docs/rancher/v1.4/en/">Rancher v1.4</a></li>
            <li><a href="/docs/rancher/v1.3/en/">Rancher v1.3</a></li>
            <li><a href="/docs/rancher/v1.2/en/">Rancher v1.2</a></li>
            <li><a href="/docs/rancher/v1.1/en/">Rancher v1.1</a></li>
            <li><a href="/docs/rancher/v1.0/en/">Rancher v1.0</a></li>
        </ul>
    </li>
</ul>

      </div>

      <div class="col span-8">
        <div class="content-container">
          <h2 id="scheduling-services">Scheduling Services</h2>
<hr />

<p>In Rancher, you can have the services to be scheduled on specific hosts based on strict and soft affinity/anti-affinity rules. These rules can compare the labels on a host or the labels on the container on a host to determine which host the container should be scheduled on.</p>

<p>By default, Rancher will detect port conflicts on a host and not schedule containers that require a port onto a host if the port is not available.</p>

<p>This core scheduling logic is built into Rancher, but Rancher also supports additional scheduling abilities that are located in our <a href="/docs/rancher/v1.6/en/rancher-services/scheduler/">external scheduler</a>, which is part of our <a href="/docs/rancher/v1.6/en/rancher-services/">infrastructure services</a>. Additional scheduling abilities include:</p>

<ul>
  <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/#multiple-ips">Ability to schedule against multiple IPs on a Host</a></li>
  <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/#resource-constraints">Ability to scheduler based on resource constraints (i.e. CPU and memory)</a></li>
  <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/#restrict-services-on-host">Ability to restrict which services can be scheduled on a host</a></li>
</ul>

<h3 id="labels-and-scheduling-rules">Labels and Scheduling rules</h3>

<p>When launching containers either through a <a href="/docs/rancher/v1.6/en/cattle/adding-services/">service</a> or through a <a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/">load balancer</a>, we provide the option to create labels for the container(s) and the ability to schedule which host you want the container to be placed on. For the remaining part of this section, we’ll use the term service, but these labels also apply to load balancers (i.e. a specific type of service).</p>

<p>The scheduling rules provide flexibility on how you want Rancher to pick which host to use. In Rancher, we use labels to help define scheduling rules. You can create as many labels on a container as you’d like. With multiple scheduling rules, you have complete control on which host you want the container to be created on. You could request that the container to be launched on a host with a specific host label, container label or name, or a specific service. These scheduling rules can help create blacklists and whitelists for your container to host relationships.</p>

<h3 id="adding-labels-in-the-ui">Adding Labels in the UI</h3>

<p>For <a href="/docs/rancher/v1.6/en/cattle/adding-services/">services</a>, labels can be added in the <strong>Labels</strong> tab. For load balancers, labels can be found in the <strong>Labels</strong> tab.</p>

<p>By adding labels to a <a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/">load balancer</a>, every load balancer container will receive that label, which is a key value pair. In Rancher, we use these container labels to help define scheduling rules. You can create as many labels on a load balancer as you’d like. By default, Rancher already adds system related labels on every container.</p>

<h3 id="scheduling-options-in-the-ui">Scheduling Options in the UI</h3>

<p>For <a href="/docs/rancher/v1.6/en/cattle/adding-services/">services</a> and <a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/">load balancers</a>, labels can be found in the <strong>Scheduling</strong> tab.</p>

<p>For <a href="/docs/rancher/v1.6/en/cattle/adding-services/">services</a>, there are 2 options provided to determine where to launch your container.</p>

<h4 id="option-1-run-all-containers-on-a-specific-host">Option 1: Run <em>all</em> containers on a specific host</h4>
<p>By selecting this option, the container/service will be started on a specific host. If your host goes down, then the container will also go down. If you create a container from the container page, even if there is a port conflict, the container will be started. If you create a service of scale greater than 1 and there is a port conflict, your service might get stuck in <em>Activating</em> state until you edit the scale value of the service.</p>

<h4 id="option-2-automatically-pick-a-host-matching-scheduling-rules">Option 2: Automatically pick a host matching scheduling rules</h4>
<p>By selecting this option, you have the flexibility to choose your scheduling rules. Any host that follows all the rules is a host that could have the container started on. You can add rules by clicking on the <strong>+</strong> button.</p>

<p>For <a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/">load balancers</a>, only option 2 is available due to port conflicts. You are only given the choice to add scheduling rules. Click on the <strong>Scheduling</strong> tab. You can add as many scheduling rules as you want by clicking on the <strong>Add Scheduling Rule</strong> button.</p>

<p>For each rule, you select a <strong>condition</strong> of the rule. There are 4 different conditions, which define how strict the rule must be followed. The <strong>field</strong> determines which field you want the rule to be applied to. The <strong>key</strong> and <strong>value</strong> are the values which you want the field to be checked against. If you are launching a service or load balancer, Rancher will spread the distribution of containers on the applicable hosts based on the load of each host. Depending on the condition chosen will determine what the applicable hosts are.</p>

<blockquote>
  <p><strong>Note:</strong> For <a href="/docs/rancher/v1.6/en/cattle/adding-services/">services</a>/<a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/">load balancers</a>, if you have selected the <strong>Always run one instance of this container on every host</strong> option for scale, then only the host labels will appear as a possible field.</p>
</blockquote>

<h4 id="conditions">Conditions</h4>

<ul>
  <li><strong>must</strong> or <strong>must not</strong>: Rancher will only use hosts that match or do not match the field and value. If Rancher cannot find a host that meets all of the rules with these conditions, your service could get stuck in an <em>Activating</em> state. The service will be continually trying to find a host for the containers. To fix this state, you can either edit the scale value of the service or add/edit another host that would satisfy all of these rules.</li>
  <li><strong>should</strong> or <strong>should not</strong>: Rancher will attempt to use hosts that match the field and value. In the case of when there is no  host that matches all the rules, Rancher will remove one by one the soft constraints (should/should not rules) until a host satisfies the remaining constraints.</li>
</ul>

<h4 id="fields">Fields</h4>

<ul>
  <li><strong>host label</strong>: When selecting the hosts to use for the container/service, Rancher will check the labels on the host to see if they match the key/value pair provided. Since every host can have one or more labels, Rancher will compare the key/value pair against all labels on a host. When adding a host to Rancher, you can add labels to the host. You can also edit the labels on the hosts by using the <strong>Edit</strong> option in the host’s dropdown menu. The list of labels on active hosts are available from the dropdown in the key field.</li>
  <li><strong>container with label</strong>: When selecting this field, Rancher will look for hosts that already have containers with labels that match the key/value pair. Since every container can have one or more labels, Rancher will compare the key/value pair against all labels on every container in a host. The container labels are in the <strong>Labels</strong> tab for a container. You will not be able to edit the container labels after the container is started. In order to create a new container with the same settings, you can <strong>Clone</strong> the container/service and add the labels before starting it. The list of user labels on running containers are available from the dropdown in the key field.</li>
  <li><strong>service with the name</strong>: Rancher will check to see if a host has a container from the specified service running on it. If at a later time, this service has a name change or is inactive/removed, the rule will no longer be valid. If you pick this field, the value will need to be in the format of <code class="highlighter-rouge">stack_name/service_name</code>. The list of running services are available from the dropdown in the value field.</li>
  <li><strong>container with the name</strong>: Rancher will check to see if a host has a container with a specific name running on it. If at a later time, the container has a name change or is inactive/removed, the rule will no longer be valid. The list of running containers are available from the dropdown in the value field.</li>
</ul>

<h3 id="adding-labels-in-rancher-compose">Adding Labels in Rancher Compose</h3>

<p>Rancher determines how to schedule a service’s containers based on the <code class="highlighter-rouge">labels</code> defined in the <code class="highlighter-rouge">docker-compose.yml</code> file. All of the labels with scheduling would be used in the <code class="highlighter-rouge">docker-compose.yml</code> file. Rancher defines the scheduling rules with 3 main components: conditions, fields and values. Conditions determine how strictly Rancher follows the rules. Fields are which items that are going to be compared against. Values are what you’ve defined on the fields. We’ll talk broadly about these components before going into some examples.</p>

<h4 id="scheduling-conditions">Scheduling Conditions</h4>

<p>When we write our scheduling rules, we have conditions for each rule, which dictates how Rancher uses the rule. An affinity condition is when we are trying to find a field that matches our value. An anti-affinity condition is when we are trying to find a field that does not match our value.</p>

<p>To differentiate between affinity and anti-affinity, we add <code class="highlighter-rouge">_ne</code> to the label name to indicate that the label is <strong>not</strong> matching the field and values.</p>

<p>There are also hard and soft conditions of a rule.</p>

<p>A hard condition is the equivalent of saying <strong>must</strong> or <strong>must not</strong>. Rancher will only use hosts that match or do not match the field and value. If Rancher cannot find a host that meets all of the rules with these conditions, your service could get stuck in an <em>Activating</em> state. The service will be continually trying to find a host for the containers. To fix this state, you can either edit the scale value of the service or add/edit another host that would satisfy all of these rules.</p>

<p>A soft condition is the equivalent of saying <strong>should</strong> or <strong>should not</strong>. Rancher will attempt to use hosts that match the field and value. In the case of when there is no  host that matches all the rules, Rancher will remove one by one the soft constraints (should/should not rules) until a host satisfies the remaining constraints.</p>

<p>To differentiate between the <em>must</em> and <em>should</em> conditions, we add <code class="highlighter-rouge">_soft</code> to our label name to indicate that the label is <strong>should</strong> try to match the field and values.</p>

<h4 id="fields-1">Fields</h4>

<p>Rancher has the ability to compare values against host labels, container labels, container name, or service name. The label prefix is what Rancher uses to define which field will be evaluated.</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Label Prefix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Host Label</td>
      <td><code class="highlighter-rouge">io.rancher.scheduler.affinity:host_label</code></td>
    </tr>
    <tr>
      <td>Container Label/Service Name</td>
      <td><code class="highlighter-rouge">io.rancher.scheduler.affinity:container_label</code></td>
    </tr>
    <tr>
      <td>Container Name</td>
      <td><code class="highlighter-rouge">io.rancher.scheduler.affinity:container</code></td>
    </tr>
  </tbody>
</table>

<p>Notice how there is not a specific prefix for service name. When Rancher creates a service, system labels are added to all containers of the service to indicate the stack and service name.</p>

<p>To create the key of our label, we start with a field prefix (e.g. <code class="highlighter-rouge">io.rancher.scheduler.affinity:host_label</code>) and based on the condition that we are looking for, we append the type of condition we want. For example, if we want the containers to be launched on a host that must not equal (i.e. <code class="highlighter-rouge">_ne</code>) to a host label value, the label key would be <code class="highlighter-rouge">io.rancher.scheduler.affinity:host_label_ne</code>.</p>

<h4 id="values">Values</h4>

<p>You use the values to define what you want the field to be checked against. If you have a couple of values that you want to compare against for the same condition and field, you’ll need to use only one label for the name of the label. For the value of the label, you’ll need to use a comma separated list. If there are multiple labels with the same key (e.g. <code class="highlighter-rouge">io.rancher.scheduler.affinity:host_label_ne</code>), Rancher will overwrite any previous value with the last value that is used with the label key.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">labels</span><span class="pi">:</span>
  <span class="s">io.rancher.scheduler.affinity:host_label</span><span class="pi">:</span> <span class="s">key1=value1,key2=value2</span>
</code></pre>
</div>

<h4 id="global-service">Global Service</h4>

<p>Making a service into a global service is the equivalent of selecting <strong>Always run one instance of this container on every host</strong> in the UI. This means that a container will be started on any host in the <a href="/docs/rancher/v1.6/en/environments/">environment</a>. If a new host is added to the environment, and the host fulfills the global service’s host requirements, the service will automatically be started.</p>

<p>Currently, we only support global services with host labels fields that are using the hard condition. This means that only labels that are related to <code class="highlighter-rouge">host_labels</code> will be adhered to when scheduling and it <strong>must</strong> or <strong>must not</strong> equal the values. Any other label types will be ignored.</p>

<h5 id="example-docker-composeyml">Example <code class="highlighter-rouge">docker-compose.yml</code></h5>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2'</span>
<span class="s">services</span><span class="pi">:</span>
  <span class="s">wordpress</span><span class="pi">:</span>
    <span class="s">labels</span><span class="pi">:</span>
      <span class="c1"># Make wordpress a global service</span>
      <span class="s">io.rancher.scheduler.global</span><span class="pi">:</span> <span class="s1">'</span><span class="s">true'</span>
      <span class="c1"># Make wordpress only run containers on hosts with a key1=value1 label</span>
      <span class="s">io.rancher.scheduler.affinity:host_label</span><span class="pi">:</span> <span class="s">key1=value1</span>
      <span class="c1"># Make wordpress only run on hosts that do not have a key2=value2 label</span>
      <span class="s">io.rancher.scheduler.affinity:host_label_ne</span><span class="pi">:</span> <span class="s">key2=value2</span>
    <span class="s">image</span><span class="pi">:</span> <span class="s">wordpress</span>
    <span class="s">links</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">db</span><span class="pi">:</span> <span class="s">mysql</span>
    <span class="s">stdin_open</span><span class="pi">:</span> <span class="s">true</span>
</code></pre>
</div>

<h4 id="finding-hosts-with-host-labels">Finding Hosts with Host Labels</h4>

<p>When adding hosts to Rancher, you can add <a href="/docs/rancher/v1.6/en/hosts/#host-labels">host labels</a>. When scheduling a service, you can leverage these labels to create rules to pick the hosts you want your service to be deployed on.</p>

<h5 id="example-using-host-labels">Example using Host Labels</h5>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">labels</span><span class="pi">:</span>
  <span class="c1"># Host MUST have the label `key1=value1`</span>
  <span class="s">io.rancher.scheduler.affinity:host_label</span><span class="pi">:</span> <span class="s">key1=value1</span>
  <span class="c1"># Host MUST NOT have the label `key2=value2`</span>
  <span class="s">io.rancher.scheduler.affinity:host_label_ne</span><span class="pi">:</span> <span class="s">key2=value2</span>
  <span class="c1"># Host SHOULD have the label `key3=value3`</span>
  <span class="s">io.rancher.scheduler.affinity:host_label_soft</span><span class="pi">:</span> <span class="s">key3=value3</span>
  <span class="c1"># Host SHOULD NOT have the label `key4=value4`</span>
  <span class="s">io.rancher.scheduler.affinity:host_label_soft_ne</span><span class="pi">:</span> <span class="s">key4=value4</span>
</code></pre>
</div>

<h5 id="automatically-applied-host-labels">Automatically Applied Host Labels</h5>

<p>Rancher automatically creates host labels related to linux kernel version and Docker Engine version of the host.</p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">io.rancher.host.linux_kernel_version</code></td>
      <td>Linux Kernel Version on Host (e.g, <code class="highlighter-rouge">3.19</code>)</td>
      <td>Version of the Linux kernel running on the host</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">io.rancher.host.docker_version</code></td>
      <td>Docker Engine Version on the host (e.g. <code class="highlighter-rouge">1.10.3</code>)</td>
      <td>Docker Engine Version on the host</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">io.rancher.host.provider</code></td>
      <td>Cloud provider info</td>
      <td>Cloud provider name (currently only applied for AWS)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">io.rancher.host.region</code></td>
      <td>Cloud provider region</td>
      <td>Cloud provider region (currently only applied for AWS)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">io.rancher.host.zone</code></td>
      <td>Cloud provider zone</td>
      <td>Cloud provider zone (currently only applied for AWS)</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">labels</span><span class="pi">:</span>
<span class="c1"># Host MUST be running Docker version 1.10.3</span>
<span class="s">io.rancher.scheduler.affinity:host_label</span><span class="pi">:</span> <span class="s">io.rancher.host.docker_version=1.10.3</span>
<span class="c1"># Host MUST not be running Docker version 1.6</span>
<span class="s">io.rancher.scheduler.affinity:host_label_ne</span><span class="pi">:</span> <span class="s">io.rancher.host.docker_version=1.6</span>
</code></pre>
</div>

<p><br /></p>

<blockquote>
  <p><strong>Note:</strong> Rancher does not support the concept of scheduling containers on a host that has <code class="highlighter-rouge">&gt;=</code> a specific version. You can create specific whitelists and blacklists by using the host scheduling rules to determine if a specific version of Docker Engine is required for your services.</p>
</blockquote>

<h4 id="finding-hosts-with-container-labels">Finding Hosts with Container Labels</h4>

<p>When adding containers or services to Rancher, you can add container labels. These labels can be used for the field that you want a rule to compare against. Reminder: This cannot be used if you set global service to true.</p>

<blockquote>
  <p><strong>Note:</strong> If there are multiple values for container labels, Rancher will look at all labels on all containers on the host to check the container labels. The multiple values do not need to be on the same container on a host.</p>
</blockquote>

<h5 id="example-using-container-labels">Example using Container Labels</h5>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">labels</span><span class="pi">:</span>
  <span class="c1"># Host MUST have a container with the label `key1=value1`</span>
  <span class="s">io.rancher.scheduler.affinity:container_label</span><span class="pi">:</span> <span class="s">key1=value1</span>
  <span class="c1"># Host MUST NOT have a container with the label `key2=value2`</span>
  <span class="s">io.rancher.scheduler.affinity:container_label_ne</span><span class="pi">:</span> <span class="s">key2=value2</span>
  <span class="c1"># Host SHOULD have a container with the label `key3=value3`</span>
  <span class="s">io.rancher.scheduler.affinity:container_label_soft</span><span class="pi">:</span> <span class="s">key3=value3</span>
  <span class="c1"># Host SHOULD NOT have a container with the label `key4=value4</span>
  <span class="s">io.rancher.scheduler.affinity:container_label_soft_ne</span><span class="pi">:</span> <span class="s">key4=value4</span>
</code></pre>
</div>

<h5 id="service-name">Service Name</h5>

<p>When Rancher Compose starts containers for a service, it also automatically creates several container labels. Since checking for a specific container label is looking for a <code class="highlighter-rouge">key=value</code>, we can use these system labels as the key of our rules. Here are the system labels created on the containers when Rancher starts a service:</p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>io.rancher.stack.name</td>
      <td><code class="highlighter-rouge">$${stack_name}</code></td>
    </tr>
    <tr>
      <td>io.rancher.stack_service.name</td>
      <td><code class="highlighter-rouge">$${stack_name}/$${service_name}</code></td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<blockquote>
  <p><strong>Note:</strong> When using the <code class="highlighter-rouge">io.rancher.stack_service.name</code>, the value must be in the format of <code class="highlighter-rouge">stack name/service name</code>.</p>
</blockquote>

<p>The macros <code class="highlighter-rouge">$${stack_name}</code> and <code class="highlighter-rouge">$${service_name}</code> can also be used in the <code class="highlighter-rouge">docker-compose.yml</code> file in any other <code class="highlighter-rouge">label</code> and will be evaluated when the service is started.</p>

<h5 id="example-using-service-name">Example using Service Name</h5>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">labels</span><span class="pi">:</span>
  <span class="c1"># Host MUST have a container from service name `value1`</span>
  <span class="s">io.rancher.scheduler.affinity:container_label</span><span class="pi">:</span> <span class="s">io.rancher.stack_service.name=stackname/servicename</span>
</code></pre>
</div>

<h4 id="finding-hosts-with-container-names">Finding Hosts with Container Names</h4>

<p>When adding containers to Rancher, you give each container a name. You can use this name as a field that you want a rule to compare against. Reminder: This cannot be used if you set global service to true.</p>

<h5 id="example-using-container-names">Example using Container Names</h5>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">labels</span><span class="pi">:</span>
  <span class="c1"># Host MUST have a container with the name `value1`</span>
  <span class="s">io.rancher.scheduler.affinity:container</span><span class="pi">:</span> <span class="s">value1</span>
  <span class="c1"># Host MUST NOT have a container with the name `value2`</span>
  <span class="s">io.rancher.scheduler.affinity:container_ne</span><span class="pi">:</span> <span class="s">value2</span>
  <span class="c1"># Host SHOULD have a container with the name `value3`</span>
  <span class="s">io.rancher.scheduler.affinity:container_soft</span><span class="pi">:</span> <span class="s">value3</span>
  <span class="c1"># Host SHOULD NOT have a container with the name `value4</span>
  <span class="s">io.rancher.scheduler.affinity:container_soft_ne</span><span class="pi">:</span> <span class="s">value4</span>
</code></pre>
</div>

<h3 id="examples">Examples</h3>

<h4 id="example-1">Example 1:</h4>

<p>A typical scheduling policy may be to try to spread the containers of a service across the different available hosts.  One way to achieve this is to use an anti-affinity rule to itself:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">labels</span><span class="pi">:</span>
  <span class="s">io.rancher.scheduler.affinity:container_label_ne</span><span class="pi">:</span> <span class="s">io.rancher.stack_service.name=$${stack_name}/$${service_name}</span>
</code></pre>
</div>

<p>Since this is a hard anti-affinity rule, we may run into problems if the scale is larger than the number of hosts available.  In this case, we might want to use a soft anti-affinity rule so that the scheduler is still allowed to deploy a container to a host that already has that container running.  Basically, this is a soft rule so it can be ignored if no better alternative exists.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">labels</span><span class="pi">:</span>
  <span class="s">io.rancher.scheduler.affinity:container_label_soft_ne</span><span class="pi">:</span> <span class="s">io.rancher.stack_service.name=$${stack_name}/$${service_name}</span>
</code></pre>
</div>

<h4 id="example-2">Example 2:</h4>

<p>Another example may be to deploy all the containers on the same host regardless of which host that may be.  In this case, a soft affinity to itself can be used.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">labels</span><span class="pi">:</span>
  <span class="s">io.rancher.scheduler.affinity:container_label_soft</span><span class="pi">:</span> <span class="s">io.rancher.stack_service.name=$${stack_name}/$${service_name}</span>
</code></pre>
</div>

<p>If a hard affinity rule to itself was chosen instead, the deployment of the first container would fail since there would be no host that currently has that service running.</p>

<h3 id="table-of-scheduling-labels">Table of Scheduling Labels</h3>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>io.rancher.scheduler.global</td>
      <td>true</td>
      <td>Specifies this service to be a global service</td>
    </tr>
    <tr>
      <td>io.rancher.scheduler.affinity:host_label</td>
      <td>key1=value1,key2=value2, etc…</td>
      <td>Containers <strong>must</strong> be deployed to a host with the labels <code class="highlighter-rouge">key1=value1</code> and <code class="highlighter-rouge">key2=value2</code></td>
    </tr>
    <tr>
      <td>io.rancher.scheduler.affinity:host_label_soft</td>
      <td>key1=value1,key2=value2</td>
      <td>Containers <strong>should</strong> be deployed to a host with the labels <code class="highlighter-rouge">key1=value1</code> and <code class="highlighter-rouge">key2=value2</code></td>
    </tr>
    <tr>
      <td>io.rancher.scheduler.affinity:host_label_ne</td>
      <td>key1=value1,key2=value2</td>
      <td>Containers <strong>must not</strong> be deployed to a host with the label <code class="highlighter-rouge">key1=value1</code> or <code class="highlighter-rouge">key2=value2</code></td>
    </tr>
    <tr>
      <td>io.rancher.scheduler.affinity:host_label_soft_ne</td>
      <td>key1=value1,key2=value2</td>
      <td>Containers <strong>should not</strong> be deployed to a host with the label <code class="highlighter-rouge">key1=value1</code> or <code class="highlighter-rouge">key2=value2</code></td>
    </tr>
    <tr>
      <td>io.rancher.scheduler.affinity:container_label</td>
      <td>key1=value1,key2=value2</td>
      <td>Containers <strong>must</strong> be deployed to a host that has containers running with the labels <code class="highlighter-rouge">key1=value1</code> and <code class="highlighter-rouge">key2=value2</code>.  NOTE: These labels do not have to be on the same container.  The can be on different containers within the same host.</td>
    </tr>
    <tr>
      <td>io.rancher.scheduler.affinity:container_label_soft</td>
      <td>key1=value1,key2=value2</td>
      <td>Containers <strong>should</strong> be deployed to a host that has containers running with the labels <code class="highlighter-rouge">key1=value1</code> and <code class="highlighter-rouge">key2=value2</code></td>
    </tr>
    <tr>
      <td>io.rancher.scheduler.affinity:container_label_ne</td>
      <td>key1=value1,key2=value2</td>
      <td>Containers <strong>must not</strong> be deployed to a host that has containers running with the label <code class="highlighter-rouge">key1=value1</code> or <code class="highlighter-rouge">key2=value2</code></td>
    </tr>
    <tr>
      <td>io.rancher.scheduler.affinity:container_label_soft_ne</td>
      <td>key1=value1,key2=value2</td>
      <td>Containers <strong>should not</strong> be deployed to a host that has containers running with the label <code class="highlighter-rouge">key1=value1</code> or <code class="highlighter-rouge">key2=value2</code></td>
    </tr>
    <tr>
      <td>io.rancher.scheduler.affinity:container</td>
      <td>container_name1,container_name2</td>
      <td>Containers <strong>must</strong> be deployed to a host that has containers with the names <code class="highlighter-rouge">container_name1</code> and <code class="highlighter-rouge">container_name2</code> running</td>
    </tr>
    <tr>
      <td>io.rancher.scheduler.affinity:container_soft</td>
      <td>container_name1,container_name2</td>
      <td>Containers <strong>should</strong> be deployed to a host that has containers with the names <code class="highlighter-rouge">container_name1</code> and <code class="highlighter-rouge">container_name2</code> running</td>
    </tr>
    <tr>
      <td>io.rancher.scheduler.affinity:container_ne</td>
      <td>container_name1,container_name2</td>
      <td>Containers <strong>must not</strong> be deployed to a host that has containers with the names <code class="highlighter-rouge">container_name1</code> or <code class="highlighter-rouge">container_name2</code> running</td>
    </tr>
    <tr>
      <td>io.rancher.scheduler.affinity:container_soft_ne</td>
      <td>container_name1,container_name2</td>
      <td>Containers <strong>should not</strong> be deployed to a host that has containers with the names <code class="highlighter-rouge">container_name1</code> or <code class="highlighter-rouge">container_name2</code> running</td>
    </tr>
  </tbody>
</table>


          <footer class="clearfix">
            <div class="copyright pull-left">Copyright &copy; 2014-2017 <a href="http://rancher.com">Rancher Labs</a>.  All Rights Reserved.</div>
            <a class="btn btn-primary pull-right" href="https://github.com/rancher/rancher.github.io/tree/master/rancher/v1.6/en/cattle/scheduling/index.md">Edit this page <i class="fa fa-pencil"></i></a>
          </footer>
        </div>
      </div>
    </div>

    <script src="/docs/vendor/jquery.js?t=2017-09-13 18:12:52 -0700"></script>
    <script src="/docs/js/jquery.slicknav.min.js?t=2017-09-13 18:12:52 -0700"></script>
    <script src="/docs/js/rancher-docs.js?t=2017-09-13 18:12:52 -0700"></script>

    <!-- Start of Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-56382716-3', 'auto');
        ga('send', 'pageview');
    </script>
    <!-- End of Google Analytics -->

    <!-- Start of Async HubSpot Analytics Code -->
    <script type="text/javascript">
    (function(d,s,i,r) {
    if (d.getElementById(i)){return;}
    var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
    n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/468859.js';
    e.parentNode.insertBefore(n, e);
    })(document,"script","hs-analytics",300000);
    </script>
    <!-- End of Async HubSpot Analytics Code -->
  </body>
</html>

