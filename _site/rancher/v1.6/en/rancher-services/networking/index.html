<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Networking in Rancher</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Documentation for Rancher">
    <link href="/docs/favicon.png" rel="shortcut icon" type="image/png" sizes="16x16">
    <link href="/docs/css/syntax.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/vendor/font-awesome/css/font-awesome.min.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/vendor/lato/lato.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/css/lacsso.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/css/slicknav.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/css/rancher-docs.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
  </head>
  <body class="bg-default">
    <div class="row body">
      <header id="header" class="section">
        <nav class="row" role="navigation">
          <div class="col span-3">
          <a class="navbar-brand" href="/"><img src="/docs/img/rancher-logo-nopadding.svg" width="200px" style="padding-left: 20px" /></a>
          </div>

          <div class="col span-5 offset-3">
            <!--Start Google Search-->
            <div class="gcse-search" id="google-search"></div>
            <script>
              var match = window.location.pathname.match(/\/rancher\/([^\/]+)/);
              if ( match ) {
                document.getElementById('google-search').setAttribute('data-defaultToRefinement', match[1]);
              }

              (function() {
                var cx = '007896692384436596364:60akf3bfmxm';
                var gcse = document.createElement('script');
                gcse.type = 'text/javascript';
                gcse.async = true;
                gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(gcse, s);
              })();
            </script>
            <!--End Google Search-->
          </div>
        </nav>
      </header>
      <div class="col span-3 mt-0 mr-0 sidebar">

<ul id="menu">
    <li><a href="/docs/rancher/v1.6/en/">Overview</a></li>
    <li><a href="/docs/rancher/v1.6/en/quick-start-guide/">Quick Start Guide</a></li>
    <li>
        <a href="#">Installing Rancher<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/">Rancher Server</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#requirements">Rancher Server Requirements</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#rancher-server-tags">Rancher Server Tags</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#single-container">Launching Rancher Server</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#multi-nodes">Setting up HA</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#requirements-for-ha">HA Requirements</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#single-container-external-database">Using an External DB</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#single-container-bind-mount">Bind Mounted MySQL Volume</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#elb">Using an ELB in AWS</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#ldap">Using LDAP/AD with TLS</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#http-proxy">Behind an HTTP Proxy</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/selinux/">SELinux Requirements for RHEL/CentOS</a></li>
          <li>
               <a href="#">Basic SSL Configuration<i class="pull-right fa fa-angle-down"></i></a>
               <ul>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#requirements">Requirements</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#example-nginx-configuration">Example NGINX Configuration</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#example-apache-configuration">Example Apache Configuration</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#example-haproxy-configuration">Example HAProxy Configuration</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#example-f5-big-ip-configuration">Example F5 BIG-IP Configuration</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#elb">Using an ELB in AWS with SSL</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#using-self-signed-certs-beta">Using Self Signed Certs</a></li>
               </ul>
          </li>
          <li>
               <a href="#">No Internet Access<i class="pull-right fa fa-angle-down"></i></a>
               <ul>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/no-internet-access/#using-a-private-registry">Using a Private Registry</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/no-internet-access/#using-an-http-proxy">Using an HTTP Proxy</a></li>
               </ul>
          </li>
        </ul>
    </li>
    <li>
         <a href="#">Upgrading Rancher<i class="pull-right fa fa-angle-down"></i></a>
         <ul>
           <li><a href="/docs/rancher/v1.6/en/upgrading/">Upgrading Rancher</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#rancher-server-tags">Rancher Server Tags</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#infrastructure-services">Upgrading Infrastructure Services</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#multi-nodes">Upgrading Rancher HA Setup</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#single-container-external-database">Using an external DB</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#single-container-bind-mount">Bind Mounted MySQL Volume</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#rancher-server-with-no-internet-access">No Internet Access</a></li>
        </ul>
     </li>
    <li>
         <a href="#">Rancher Configuration<i class="pull-right fa fa-angle-down"></i></a>
         <ul>
           <li>
                <a href="#">Access Control Providers<i class="pull-right fa fa-angle-down"></i></a>
                <ul>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#active-directory">Active Directory</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#azure-ad">Azure AD</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#github">Github</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#local-authentication">Local Authentication</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#openldap">OpenLDAP</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#shibboleth">Shibboleth/SAML</a></li>
                </ul>
          </li>
          <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#site-access">Rancher Site Access</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#restricting-concurrent-sessions">Restricting Concurrent Sessions</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/accounts/">Accounts</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/settings/#host-registration">Host Registration</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/settings/#catalog">Enabling Catalogs</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/machine-drivers/">Machine Drivers</a></li>
        </ul>
    </li>
    <li>
          <a href="#">Environments<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
            <li><a href="/docs/rancher/v1.6/en/environments/">Managing Environments</a></li>
            <li><a href="/docs/rancher/v1.6/en/environments/#what-is-an-environment-template">Environment Templates</a></li>
            <li><a href="/docs/rancher/v1.6/en/environments/#membership-roles">Roles in an Environment</a></li>
          </ul>
    </li>
    <li>
        <a href="#">Hosts<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
          <li><a href="/docs/rancher/v1.6/en/hosts/">Getting Started with Hosts</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#supported-docker-versions">Supported Docker Versions</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#host-labels">Adding Host Labels</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#scheduler-ips">Adding Scheduler IPs</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#hosts-behind-an-http-proxy">Behind an HTTP Proxy</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/custom/">Adding Custom Hosts</a></li>
          <li>
              <a href="#">Adding Cloud Provided Hosts<i class="pull-right fa fa-angle-down"></i></a>
              <ul>
                <li><a href="/docs/rancher/v1.6/en/hosts/amazon/">Adding Amazon EC2 Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/azure/">Adding Azure Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/digitalocean/">Adding DigitalOcean Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/exoscale/">Adding Exoscale Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/packet/">Adding Packet Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/rackspace/">Adding Rackspace Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/other/">Adding Hosts from Other Cloud Providers</a></li>
              </ul>
          </li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#accessing-hosts-from-the-cloud-providers">Accessing Cloud Provided Hosts</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#removing-hosts">Removing Hosts</a></li>
        </ul>
    </li>
    <li>
      <a href="#">Registries<i class="pull-right fa fa-angle-down"></i></a>
      <ul>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/">Adding Private Registries</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#insecure-registries">Insecure Registries</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#self-signed-certificates">Self Signed Certificates</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#using-amazons-ecr-registry">Using Amazon's ECR</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#using-google-container-registry">Using Google Container Registry</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#changing-the-default-registry">Changing the Default Registry</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#limiting-which-registries-can-be-used">Limiting Registries</a></li>
      </ul>
    </li>
    <li><a href="/docs/rancher/v1.6/en/environments/certificates/">Certificates</a></li>
    <li>
      <a href="#">Infrastructure Services<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/">Infrastructure Services</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/networking/">Networking</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/network-policy/">Network Policies</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/load-balancer">Load Balancer</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/dns-service/">DNS Service</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/metadata-service/">Metadata Service</a></li>
              <li>
                  <a href="#">Persistent Storage Service<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/storage-service/">Persistent Storage Service</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/storage-service/rancher-nfs/">Rancher NFS</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/storage-service/rancher-ebs/">Rancher EBS</a></li>
                  </ul>
              </li>
              <li>
                  <a href="#">External Scheduler<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/">External Scheduler</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/#multiple-ips">Scheduling against multiple IPs</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/#resource-constraints">Scheduling with Resource Constraints</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/#restrict-services-on-host">Scheduling only Specific Services on a Host</a></li>
                  </ul>
              </li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/audit-log/">Audit Logging</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/service-accounts/">Service Accounts</a></li>
           </ul>
    </li>
    <li>
          <a href="#">Cattle<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
                <li><a href="/docs/rancher/v1.6/en/cattle/stacks/">Stacks</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/adding-services/">Services</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/volumes/">Volumes</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/">Load Balancers</a></li>
                <li>
                    <a href="#">Load Balancer Options in the UI<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#adding-a-load-balancer-in-the-ui">Adding Load Balancers</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#service-rule">Targeting Specific Services</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#selector-rule">Targeting Services based on Selectors</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#ssl-termination">SSL Termination</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#stickiness-policy-for-load-balancers">Stickiness Policy</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#custom-haproxy-configuration">Custom HAProxy Configuration</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#labelsscheduling-load-balancers">Labels and Scheduling</a></li>
                      </ul>
                </li>
                <li>
                    <a href="#">Load Balancer Options with CLI and Compose<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#adding-a-load-balancer-with-rancher-compose">Adding Load Balancers</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#source-ports">Defining Source Ports</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#port-rules">Port Rules</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#certificates">Certificates</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#custom-configuration">Custom HAProxy Configuration</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#stickiness-policy">Stickiness Policy</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#load-balancer-example-l7">Example of L7 Load Balancer</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#internal-load-balancer-example">Example of Internal Load Balancer</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#ssl-termination-example">Example of SSL Termination with a Load Balancer</a></li>
                      </ul>
                </li>
                <li><a href="/docs/rancher/v1.6/en/cattle/adding-external-services/">External Services</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/adding-service-alias/">Service Alias</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/health-checks/">Health Checks</a></li>
                <li>
                    <a href="#">Scheduling Services<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/en/cattle/scheduling/">Scheduling</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/scheduling/#scheduling-options-in-the-ui">Scheduling in the UI</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/scheduling/#adding-labels-in-rancher-compose">Scheduling in Rancher Compose</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/scheduling/#table-of-scheduling-labels">Table of Scheduling Labels</a></li>
                    </ul>
                </li>
                <li><a href="/docs/rancher/v1.6/en/cattle/upgrading/">Upgrading Services</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/internal-dns-service/">Internal DNS Service in Cattle Environments</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/external-dns-service/">External DNS Service</a></li>
                <li>
                    <a href="#">Rancher-Compose<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/en/cattle/rancher-compose/">Rancher Compose</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/rancher-compose/commands/">Commands and Options</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/rancher-compose/environment-interpolation/">Environment Interpolation</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/rancher-compose/build/">Building with AWS S3</a></li>
                    </ul>
                </li>
                <li><a href="/docs/rancher/v1.6/en/cattle/secrets/">Secrets - Experimental</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/webhook-service/">Webhooks</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/labels/">Labels in Cattle</a></li>
          </ul>
    </li>
    <li>
          <a href="#">Kubernetes<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/">Launching Kubernetes</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/resiliency-planes/">Resiliency Planes</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/providers/">Cloud Providers</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/private-registry/">Private Registry</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/rbac/">RBAC</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/disaster-recovery/">Disaster Recovery</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/backups/">Backups</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/storage/">Persistent Storage</a></li>
              <li>
                  <a href="#">Add-ons Support<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/addons/">Add-ons Support</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/addons/#helm">Helm</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/addons/#skydns">SkyDNS</a></li>
                  </ul>
              </li>
              <li>
                  <a href="#">Ingress Support and Options<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/">Ingress Support</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#host-based-routing">Host Based Routing</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#path-based-routing">Path Based Routing</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#scale-and-other-port">Multiple Load Balancers and Selecting Ports</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#tls">Using TLS</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#blocking-http">Blocking HTTP</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#custom-haproxy">Custom HAProxy</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#scheduled-globally">Scheduling on all Hosts</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#host-scheduling">Scheduling on a specific Host</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#only-local">Targeting Only Containers on the Same Host</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#prefer-local">Prioritizing Containers on the Same Host</a></li>
                  </ul>
              </li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/upgrading/">Upgrading Kubernetes</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/deleting/">Deleting Kubernetes</a></li>

          </ul>
    </li>
    <li><a href="/docs/rancher/v1.6/en/mesos/">Mesos</a></li>
    <li><a href="/docs/rancher/v1.6/en/swarm/">Swarm - Experimental </a></li>
    <li><a href="/docs/rancher/v1.6/en/windows/">Windows - Experimental</a></li>
    <li><a href="/docs/rancher/v1.6/en/native-docker/">Using Native Docker CLI</a></li>
    <li>
            <a href="#">Rancher Catalog<i class="pull-right fa fa-angle-down"></i></a>
            <ul>
                <li><a href="/docs/rancher/v1.6/en/catalog/">Catalog</a></li>
                <li><a href="/docs/rancher/v1.6/en/catalog/private-catalog/">Creating Private Catalogs</a></li>
            </ul>
        </li>
    <li><a href="#">Rancher CLI<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
            <li><a href="/docs/rancher/v1.6/en/cli/">Rancher CLI</a></li>
            <li><a href="/docs/rancher/v1.6/en/cli/commands/">Commands and Options</a></li>
            <li><a href="/docs/rancher/v1.6/en/cli/variable-interpolation/">Variable Interpolation</a></li>
        </ul>
    </li>
    <li><a href="/docs/rancher/v1.6/en/api/v2-beta/">API Documentation</a></li>
    <li><a href="/docs/rancher/v1.6/en/contributing/">Contributing to Rancher</a></li>
    <li>
        <a href="#">FAQs<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
            <li><a href="/docs/rancher/v1.6/en/faqs/server/">FAQs about Rancher Server</a></li>
            <li><a href="/docs/rancher/v1.6/en/faqs/agents/">FAQs about Rancher Agents/Hosts</a></li>
            <li><a href="/docs/rancher/v1.6/en/faqs/troubleshooting/">Troubleshooting FAQS</a></li>
        </ul>
    </li>
    <li>
        <a href="#">Docs Archive<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
            <li><a href="/docs/rancher/v1.5/en/">Rancher v1.5</a></li>
            <li><a href="/docs/rancher/v1.4/en/">Rancher v1.4</a></li>
            <li><a href="/docs/rancher/v1.3/en/">Rancher v1.3</a></li>
            <li><a href="/docs/rancher/v1.2/en/">Rancher v1.2</a></li>
            <li><a href="/docs/rancher/v1.1/en/">Rancher v1.1</a></li>
            <li><a href="/docs/rancher/v1.0/en/">Rancher v1.0</a></li>
        </ul>
    </li>
</ul>

      </div>

      <div class="col span-8">
        <div class="content-container">
          <h2 id="networking">Networking</h2>
<hr />

<p>Rancher implements a <a href="https://github.com/containernetworking/cni">CNI</a> framework, which provides the ability to select different network drivers within Rancher. To leverage the CNI framework, an <a href="/docs/rancher/v1.6/en/environments">environment</a> is required to use the <strong>Network Services</strong> infrastructure service deployed. By default, all <a href="/docs/rancher/v1.6/en/environments/#what-is-an-environment-template">environment templates</a> have the <strong>Network Services</strong> enabled.</p>

<p>Besides the <strong>Network Services</strong> infrastructure service,  select which type of networking plugin/driver that you’d like your services to use. In our default environment templates, we have enabled <strong>IPsec</strong> network driver to create a simple and secure overlay network using IPsec tunneling.</p>

<p>When a network driver is launched into the environment, it automatically creates a default network. Any services using the <code class="highlighter-rouge">managed</code> network will be using this default network.</p>

<h3 id="differences-from-previous-releases">Differences from previous releases</h3>
<p>When using Rancher’s IPsec networking prior to the <strong>1.2</strong> release, a container in the <code class="highlighter-rouge">managed</code> network would be assigned with both a Docker bridge IP (<code class="highlighter-rouge">172.17.0.0/16</code>) and a Rancher managed IP (<code class="highlighter-rouge">10.42.0.0/16</code>) on the default <code class="highlighter-rouge">docker0</code> bridge. With the adoption of the CNI framework, any container launched in <code class="highlighter-rouge">managed</code> network will only have the Rancher managed IP (default subnet: <code class="highlighter-rouge">10.42.0.0/16</code>).</p>

<h3 id="implications-of-using-cni">Implications of using CNI</h3>

<p>The Rancher managed IP address will not be present in Docker metadata, which means it will not appear in <code class="highlighter-rouge">docker inspect</code>. Certain images may not work if it requires a Docker bridge IP. Any ports published on a host will not be shown in <code class="highlighter-rouge">docker ps</code> as Rancher manages separate IPtables for the networking.</p>

<h3 id="communication-between-containers">Communication Between Containers</h3>

<p>By default, all containers within the same environment are reachable via the <code class="highlighter-rouge">managed</code> network. If you want to alter the communication between containers, you can set up a <a href="/docs/rancher/v1.6/en/rancher-services/network-policy/">network policy</a>.</p>

<p>If you are facing issues with cross host communication, please refer to our troubleshooting <a href="/docs/rancher/v1.6/en/faqs/troubleshooting/#cross-host-communication">documentation</a>.</p>

<h3 id="networking-options">Networking options</h3>

<p>Services launched in the UI can change their networking options by navigating to the <strong>Networking</strong> tab when adding a service. In the UI, all options are available for services except for <code class="highlighter-rouge">container</code> networking. In order to use <code class="highlighter-rouge">container</code> networking for a service, you can use either Rancher CLI, Rancher Compose or Docker CLI to launch the container.</p>

<h4 id="managed">Managed</h4>
<p>By default, containers launched in Rancher using the UI or <a href="/docs/rancher/v1.6/en/cli/">Rancher CLI</a> use the <code class="highlighter-rouge">managed</code> network, which uses Rancher’s managed overlay network. All containers in the <code class="highlighter-rouge">managed</code> network are able to communicate with each other regardless of which host the container was deployed on. Most of Rancher’s features, such as load balancers or DNS service, require the service to be in the <code class="highlighter-rouge">managed</code> network.</p>

<p>Inside the container, the <code class="highlighter-rouge">ip addr</code> or <code class="highlighter-rouge">ifconfig</code> commands will show one network interface (i.e. <code class="highlighter-rouge">eth0</code>) along with the loopback interface (i.e. <code class="highlighter-rouge">lo</code>). The IP address of the network interface would be one from Rancher’s managed subnet. The default subnet is <code class="highlighter-rouge">10.42.0.0/16</code>, but can be configured to your own subnet.</p>

<blockquote>
  <p><strong>Note:</strong> For any containers relying on any networking launched from a network driver (i.e. <code class="highlighter-rouge">managed</code> or based on the name of the network driver), if the network infrastructure service (e.g. <code class="highlighter-rouge">ipsec</code>) is deleted, then the networking will fail for that container.</p>
</blockquote>

<h5 id="containers-created-with-the-docker-cli">Containers created with the Docker CLI</h5>
<p>For any containers launched through the Docker CLI, an extra label <code class="highlighter-rouge">--label io.rancher.container.network=true</code> can be used to launch the container into the <code class="highlighter-rouge">managed</code> network. Without this label, containers launched from the Docker CLI will be using the <code class="highlighter-rouge">bridge</code> network.</p>

<p>If you want to launch a container in <strong>only</strong> the <code class="highlighter-rouge">managed</code> network, you’d need to add <code class="highlighter-rouge">--net=none</code> and <code class="highlighter-rouge">--label io.rancher.container.network=true</code> for the container to be started without the <code class="highlighter-rouge">bridge</code> network.</p>

<h4 id="none">None</h4>
<p>When a container is launched with <code class="highlighter-rouge">none</code> for networking, the container is launched with no networking enabled. This is equivalent to launching a container from the Docker command line with the option <code class="highlighter-rouge">--net=none</code>.</p>

<p>Inside the container, the <code class="highlighter-rouge">ip addr</code> or <code class="highlighter-rouge">ifconfig</code> commands will not show any network interfaces except for the loopback (i.e. <code class="highlighter-rouge">lo</code>).</p>

<h4 id="host">Host</h4>
<p>When a container is launched with <code class="highlighter-rouge">host</code> networking, the container is launched with the same networking interfaces available to the host. This is equivalent to launching a container from the Docker command line with the option <code class="highlighter-rouge">--net=host</code>.</p>

<p>Inside the container, the <code class="highlighter-rouge">ip addr</code> or <code class="highlighter-rouge">ifconfig</code> commands will show the same networking interfaces as the host.</p>

<h4 id="bridge">Bridge</h4>
<p>When a container is launched with <code class="highlighter-rouge">bridge</code> networking, the container is launched on Docker’s default bridge. By default, it is <code class="highlighter-rouge">docker0</code> unless the system administrator has changed it on the host. This is equivalent to launching a container from the Docker command line with the option <code class="highlighter-rouge">--net=bridge</code>.</p>

<p>Inside the container, the <code class="highlighter-rouge">ip addr</code> or <code class="highlighter-rouge">ifconfig</code> commands will show one network interface (i.e. <code class="highlighter-rouge">eth0</code>) along with the loopback interface (i.e. <code class="highlighter-rouge">lo</code>). The IP address of the network interface will be one from the Docker’s subnet. The default subnet used by Docker is <code class="highlighter-rouge">172.17.0.0/16</code>.</p>

<h4 id="container">Container</h4>
<p>When a container is launched with networking from another container, the container is launched using the networking resources of the other container. This is equivalent to launching a container from the Docker command line with the option <code class="highlighter-rouge">--net=container:&lt;CONTAINER_NAME&gt;</code>.</p>

<p>Inside the container, the <code class="highlighter-rouge">ip addr</code> or <code class="highlighter-rouge">ifconfig</code> commands will show the same networking interfaces as the container that was selected. The actual IP address depends on the network mode of the original container. If the original container had <code class="highlighter-rouge">bridge</code> mode, then the IP address would be in the docker’s subnet.</p>

<h3 id="example-of-ranchers-ipsec-network-service">Example of Rancher’s IPSec Network Service</h3>

<p>To leverage the CNI framework, you can enable a network infrastructure service, which is created from a network driver in a yaml file. In the <code class="highlighter-rouge">network_driver</code> key of the yaml, there are several options that are defined.</p>

<p>Here is an example of Rancher’s IPsec infrastructure service. The <code class="highlighter-rouge">network_driver</code> is configured in the <code class="highlighter-rouge">rancher-compose.yml</code> file.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">ipsec</span><span class="pi">:</span>
  <span class="s">network_driver</span><span class="pi">:</span>
    <span class="s">name</span><span class="pi">:</span> <span class="s">Rancher IPsec</span>
    <span class="s">default_network</span><span class="pi">:</span>
      <span class="s">name</span><span class="pi">:</span> <span class="s">ipsec</span>
      <span class="s">host_ports</span><span class="pi">:</span> <span class="s">true</span>
      <span class="s">subnets</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">network_address</span><span class="pi">:</span> <span class="s">$SUBNET</span>
      <span class="s">dns</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">169.254.169.250</span>
      <span class="s">dns_search</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">rancher.internal</span>
    <span class="s">cni_config</span><span class="pi">:</span>
      <span class="s1">'</span><span class="s">10-rancher.conf'</span><span class="pi">:</span>
        <span class="s">name</span><span class="pi">:</span> <span class="s">rancher-cni-network</span>
        <span class="s">type</span><span class="pi">:</span> <span class="s">rancher-bridge</span>
        <span class="s">bridge</span><span class="pi">:</span> <span class="s">$DOCKER_BRIDGE</span>
        <span class="s">bridgeSubnet</span><span class="pi">:</span> <span class="s">$SUBNET</span>
        <span class="s">logToFile</span><span class="pi">:</span> <span class="s">/var/log/rancher-cni.log</span>
        <span class="s">isDebugLevel</span><span class="pi">:</span> <span class="s">${RANCHER_DEBUG}</span>
        <span class="s">isDefaultGateway</span><span class="pi">:</span> <span class="s">true</span>
        <span class="s">hostNat</span><span class="pi">:</span> <span class="s">true</span>
        <span class="s">hairpinMode</span><span class="pi">:</span> <span class="s">true</span>
        <span class="s">mtu</span><span class="pi">:</span> <span class="s">${MTU}</span>
        <span class="s">linkMTUOverhead</span><span class="pi">:</span> <span class="s">98</span>
        <span class="s">ipam</span><span class="pi">:</span>
          <span class="s">type</span><span class="pi">:</span> <span class="s">rancher-cni-ipam</span>
          <span class="s">logToFile</span><span class="pi">:</span> <span class="s">/var/log/rancher-cni.log</span>
          <span class="s">isDebugLevel</span><span class="pi">:</span> <span class="s">${RANCHER_DEBUG}</span>
          <span class="s">routes</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">dst</span><span class="pi">:</span> <span class="s">169.254.169.250/32</span>
</code></pre>
</div>

<h4 id="name">Name</h4>

<p>The name of the network driver.</p>

<h4 id="default-network">Default Network</h4>
<p>The <code class="highlighter-rouge">default_network</code> defines options for the networking in the environment.</p>

<h5 id="name-1">Name</h5>

<p>The name of the default network can be used when selecting a network mode for a service.</p>

<h5 id="host-ports">Host Ports</h5>

<p>By default, ports on a host are allowed to be published, but you can create a network that does not allow publishing ports on the host.</p>

<h5 id="subnets">Subnets</h5>

<p>You can select the network addresses for the subnet of the managed overlay network.</p>

<h5 id="dns--dns-search">DNS &amp;&amp; DNS Search</h5>

<p>The values in DNS and DNS Search  will be autopopulated in the containers.</p>

<h4 id="cni-configuration">CNI configuration</h4>

<p>For the network driver, you can set the CNI configuration within the <code class="highlighter-rouge">cni_config</code>. The example above shows the CNI configuration for Rancher’s IPsec infrastructure service.</p>

<p>Most of the options specified in the CNI config are generic except a few which are specific to Rancher’s CNI plugin implementation. This configuration can be customized by third party CNI plugin providers when they are integrating with Rancher.</p>

<h5 id="bridge-1">bridge</h5>

<p>Specify the bridge name to be used by the CNI plugin. This is a generic CNI bridge plugin option.</p>

<blockquote>
  <p>For the “Rancher IPsec” plugin, the default is <code class="highlighter-rouge">docker0</code></p>
</blockquote>

<h5 id="bridgesubnet">bridgeSubnet</h5>

<p>The subnet to use with this network plugin. This is Rancher specific option.</p>

<blockquote>
  <p>For the “Rancher IPsec” plugin, the default network is <code class="highlighter-rouge">10.42.0.0/16</code>. If you would like to use a different subnet other than this, this configuration option needs to be customized when creating a new environment template which is later used to deploy a new environment with the customized subnet.</p>
</blockquote>

<h5 id="mtu">mtu</h5>

<p>Different cloud providers have different MTU values in their networks. This option allows you to customize it to your needs. This is also a Rancher specific option. Be aware that MTU settings should be set on every component involved in providing networking; on the host itself, on the Docker daemon and inside the IPsec or VXLAN infrastructure service. Also, every host in the same environment has to have the same setting. If not all the hosts inside an environment are configured with the same MTU value, you will experience random network failures.</p>

<blockquote>
  <p>Rancher’s IPsec overlay network has an overhead of 98 bytes.<br />
<code class="highlighter-rouge">MTU of the container's network interface = MTU of the network - 98</code></p>
</blockquote>

<blockquote>
  <p>For example, if your cloud provider’s MTU is 1200 bytes then you would see an MTU of 1102 (= 1200 - 98) inside the container when you type <code class="highlighter-rouge">ip addr</code> or <code class="highlighter-rouge">ifconfig</code></p>
</blockquote>

<h5 id="changing-the-mtu">Changing the MTU</h5>

<p>Changing the MTU should be done on every component involved in providing networking; on the host itself, on the Docker daemon and in the IPsec or VXLAN infrastructure service (by defining a new environment template). Also, every host in the same environment should be configured equally. You can follow these steps if you want to change the MTU.</p>

<ul>
  <li>Change MTU on the host
    <ul>
      <li>This should be done on the network interfaces on the host, please refer to your Linux distribution documentation to see how to configure the MTU.</li>
    </ul>
  </li>
  <li>Change MTU of the Docker bridge
    <ul>
      <li>In most cases, this would be docker0. You can configure MTU by specifying the mtu setting inside <code class="highlighter-rouge">/etc/docker/daemon.json</code> like the example below, for more information, please refer to the Docker documentation on <a href="https://docs.docker.com/engine/userguide/networking/default_network/custom-docker0/">Customize the docker0 bridge</a></li>
    </ul>
  </li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"mtu"</span><span class="p">:</span><span class="w"> </span><span class="mi">1450</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<ul>
  <li>Create a new <a href="/docs/rancher/v1.6/en/environments/#what-is-an-environment-template">environment template</a> to configure the IPsec or VXLAN infrastructure service with the desired MTU.</li>
  <li>Create a new environment from the newly created environment template.</li>
</ul>

<blockquote>
  <p>MTU should only be configured in environment templates, configuring a different MTU in an existing environment is not recommended as the change will only have effect on new containers.</p>
</blockquote>


          <footer class="clearfix">
            <div class="copyright pull-left">Copyright &copy; 2014-2017 <a href="http://rancher.com">Rancher Labs</a>.  All Rights Reserved.</div>
            <a class="btn btn-primary pull-right" href="https://github.com/rancher/rancher.github.io/tree/master/rancher/v1.6/en/rancher-services/networking/index.md">Edit this page <i class="fa fa-pencil"></i></a>
          </footer>
        </div>
      </div>
    </div>

    <script src="/docs/vendor/jquery.js?t=2017-09-13 18:12:52 -0700"></script>
    <script src="/docs/js/jquery.slicknav.min.js?t=2017-09-13 18:12:52 -0700"></script>
    <script src="/docs/js/rancher-docs.js?t=2017-09-13 18:12:52 -0700"></script>

    <!-- Start of Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-56382716-3', 'auto');
        ga('send', 'pageview');
    </script>
    <!-- End of Google Analytics -->

    <!-- Start of Async HubSpot Analytics Code -->
    <script type="text/javascript">
    (function(d,s,i,r) {
    if (d.getElementById(i)){return;}
    var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
    n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/468859.js';
    e.parentNode.insertBefore(n, e);
    })(document,"script","hs-analytics",300000);
    </script>
    <!-- End of Async HubSpot Analytics Code -->
  </body>
</html>

