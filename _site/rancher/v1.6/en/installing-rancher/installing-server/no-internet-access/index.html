<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Installing Rancher Server with No Internet Access</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Documentation for Rancher">
    <link href="/docs/favicon.png" rel="shortcut icon" type="image/png" sizes="16x16">
    <link href="/docs/css/syntax.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/vendor/font-awesome/css/font-awesome.min.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/vendor/lato/lato.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/css/lacsso.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/css/slicknav.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
    <link href="/docs/css/rancher-docs.css?t=2017-09-13 18:12:52 -0700" rel="stylesheet">
  </head>
  <body class="bg-default">
    <div class="row body">
      <header id="header" class="section">
        <nav class="row" role="navigation">
          <div class="col span-3">
          <a class="navbar-brand" href="/"><img src="/docs/img/rancher-logo-nopadding.svg" width="200px" style="padding-left: 20px" /></a>
          </div>

          <div class="col span-5 offset-3">
            <!--Start Google Search-->
            <div class="gcse-search" id="google-search"></div>
            <script>
              var match = window.location.pathname.match(/\/rancher\/([^\/]+)/);
              if ( match ) {
                document.getElementById('google-search').setAttribute('data-defaultToRefinement', match[1]);
              }

              (function() {
                var cx = '007896692384436596364:60akf3bfmxm';
                var gcse = document.createElement('script');
                gcse.type = 'text/javascript';
                gcse.async = true;
                gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(gcse, s);
              })();
            </script>
            <!--End Google Search-->
          </div>
        </nav>
      </header>
      <div class="col span-3 mt-0 mr-0 sidebar">

<ul id="menu">
    <li><a href="/docs/rancher/v1.6/en/">Overview</a></li>
    <li><a href="/docs/rancher/v1.6/en/quick-start-guide/">Quick Start Guide</a></li>
    <li>
        <a href="#">Installing Rancher<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/">Rancher Server</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#requirements">Rancher Server Requirements</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#rancher-server-tags">Rancher Server Tags</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#single-container">Launching Rancher Server</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#multi-nodes">Setting up HA</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#requirements-for-ha">HA Requirements</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#single-container-external-database">Using an External DB</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#single-container-bind-mount">Bind Mounted MySQL Volume</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#elb">Using an ELB in AWS</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#ldap">Using LDAP/AD with TLS</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#http-proxy">Behind an HTTP Proxy</a></li>
          <li><a href="/docs/rancher/v1.6/en/installing-rancher/selinux/">SELinux Requirements for RHEL/CentOS</a></li>
          <li>
               <a href="#">Basic SSL Configuration<i class="pull-right fa fa-angle-down"></i></a>
               <ul>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#requirements">Requirements</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#example-nginx-configuration">Example NGINX Configuration</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#example-apache-configuration">Example Apache Configuration</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#example-haproxy-configuration">Example HAProxy Configuration</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#example-f5-big-ip-configuration">Example F5 BIG-IP Configuration</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#elb">Using an ELB in AWS with SSL</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/basic-ssl-config/#using-self-signed-certs-beta">Using Self Signed Certs</a></li>
               </ul>
          </li>
          <li>
               <a href="#">No Internet Access<i class="pull-right fa fa-angle-down"></i></a>
               <ul>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/no-internet-access/#using-a-private-registry">Using a Private Registry</a></li>
                 <li><a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/no-internet-access/#using-an-http-proxy">Using an HTTP Proxy</a></li>
               </ul>
          </li>
        </ul>
    </li>
    <li>
         <a href="#">Upgrading Rancher<i class="pull-right fa fa-angle-down"></i></a>
         <ul>
           <li><a href="/docs/rancher/v1.6/en/upgrading/">Upgrading Rancher</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#rancher-server-tags">Rancher Server Tags</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#infrastructure-services">Upgrading Infrastructure Services</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#multi-nodes">Upgrading Rancher HA Setup</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#single-container-external-database">Using an external DB</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#single-container-bind-mount">Bind Mounted MySQL Volume</a></li>
           <li><a href="/docs/rancher/v1.6/en/upgrading/#rancher-server-with-no-internet-access">No Internet Access</a></li>
        </ul>
     </li>
    <li>
         <a href="#">Rancher Configuration<i class="pull-right fa fa-angle-down"></i></a>
         <ul>
           <li>
                <a href="#">Access Control Providers<i class="pull-right fa fa-angle-down"></i></a>
                <ul>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#active-directory">Active Directory</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#azure-ad">Azure AD</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#github">Github</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#local-authentication">Local Authentication</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#openldap">OpenLDAP</a></li>
                  <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#shibboleth">Shibboleth/SAML</a></li>
                </ul>
          </li>
          <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#site-access">Rancher Site Access</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/access-control/#restricting-concurrent-sessions">Restricting Concurrent Sessions</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/accounts/">Accounts</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/settings/#host-registration">Host Registration</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/settings/#catalog">Enabling Catalogs</a></li>
          <li><a href="/docs/rancher/v1.6/en/configuration/machine-drivers/">Machine Drivers</a></li>
        </ul>
    </li>
    <li>
          <a href="#">Environments<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
            <li><a href="/docs/rancher/v1.6/en/environments/">Managing Environments</a></li>
            <li><a href="/docs/rancher/v1.6/en/environments/#what-is-an-environment-template">Environment Templates</a></li>
            <li><a href="/docs/rancher/v1.6/en/environments/#membership-roles">Roles in an Environment</a></li>
          </ul>
    </li>
    <li>
        <a href="#">Hosts<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
          <li><a href="/docs/rancher/v1.6/en/hosts/">Getting Started with Hosts</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#supported-docker-versions">Supported Docker Versions</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#host-labels">Adding Host Labels</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#scheduler-ips">Adding Scheduler IPs</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#hosts-behind-an-http-proxy">Behind an HTTP Proxy</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/custom/">Adding Custom Hosts</a></li>
          <li>
              <a href="#">Adding Cloud Provided Hosts<i class="pull-right fa fa-angle-down"></i></a>
              <ul>
                <li><a href="/docs/rancher/v1.6/en/hosts/amazon/">Adding Amazon EC2 Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/azure/">Adding Azure Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/digitalocean/">Adding DigitalOcean Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/exoscale/">Adding Exoscale Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/packet/">Adding Packet Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/rackspace/">Adding Rackspace Hosts</a></li>
                <li><a href="/docs/rancher/v1.6/en/hosts/other/">Adding Hosts from Other Cloud Providers</a></li>
              </ul>
          </li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#accessing-hosts-from-the-cloud-providers">Accessing Cloud Provided Hosts</a></li>
          <li><a href="/docs/rancher/v1.6/en/hosts/#removing-hosts">Removing Hosts</a></li>
        </ul>
    </li>
    <li>
      <a href="#">Registries<i class="pull-right fa fa-angle-down"></i></a>
      <ul>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/">Adding Private Registries</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#insecure-registries">Insecure Registries</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#self-signed-certificates">Self Signed Certificates</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#using-amazons-ecr-registry">Using Amazon's ECR</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#using-google-container-registry">Using Google Container Registry</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#changing-the-default-registry">Changing the Default Registry</a></li>
        <li><a href="/docs/rancher/v1.6/en/environments/registries/#limiting-which-registries-can-be-used">Limiting Registries</a></li>
      </ul>
    </li>
    <li><a href="/docs/rancher/v1.6/en/environments/certificates/">Certificates</a></li>
    <li>
      <a href="#">Infrastructure Services<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/">Infrastructure Services</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/networking/">Networking</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/network-policy/">Network Policies</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/load-balancer">Load Balancer</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/dns-service/">DNS Service</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/metadata-service/">Metadata Service</a></li>
              <li>
                  <a href="#">Persistent Storage Service<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/storage-service/">Persistent Storage Service</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/storage-service/rancher-nfs/">Rancher NFS</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/storage-service/rancher-ebs/">Rancher EBS</a></li>
                  </ul>
              </li>
              <li>
                  <a href="#">External Scheduler<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/">External Scheduler</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/#multiple-ips">Scheduling against multiple IPs</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/#resource-constraints">Scheduling with Resource Constraints</a></li>
                      <li><a href="/docs/rancher/v1.6/en/rancher-services/scheduler/#restrict-services-on-host">Scheduling only Specific Services on a Host</a></li>
                  </ul>
              </li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/audit-log/">Audit Logging</a></li>
              <li><a href="/docs/rancher/v1.6/en/rancher-services/service-accounts/">Service Accounts</a></li>
           </ul>
    </li>
    <li>
          <a href="#">Cattle<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
                <li><a href="/docs/rancher/v1.6/en/cattle/stacks/">Stacks</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/adding-services/">Services</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/volumes/">Volumes</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/">Load Balancers</a></li>
                <li>
                    <a href="#">Load Balancer Options in the UI<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#adding-a-load-balancer-in-the-ui">Adding Load Balancers</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#service-rule">Targeting Specific Services</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#selector-rule">Targeting Services based on Selectors</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#ssl-termination">SSL Termination</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#stickiness-policy-for-load-balancers">Stickiness Policy</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#custom-haproxy-configuration">Custom HAProxy Configuration</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#labelsscheduling-load-balancers">Labels and Scheduling</a></li>
                      </ul>
                </li>
                <li>
                    <a href="#">Load Balancer Options with CLI and Compose<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#adding-a-load-balancer-with-rancher-compose">Adding Load Balancers</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#source-ports">Defining Source Ports</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#port-rules">Port Rules</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#certificates">Certificates</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#custom-configuration">Custom HAProxy Configuration</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#stickiness-policy">Stickiness Policy</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#load-balancer-example-l7">Example of L7 Load Balancer</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#internal-load-balancer-example">Example of Internal Load Balancer</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/adding-load-balancers/#ssl-termination-example">Example of SSL Termination with a Load Balancer</a></li>
                      </ul>
                </li>
                <li><a href="/docs/rancher/v1.6/en/cattle/adding-external-services/">External Services</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/adding-service-alias/">Service Alias</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/health-checks/">Health Checks</a></li>
                <li>
                    <a href="#">Scheduling Services<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/en/cattle/scheduling/">Scheduling</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/scheduling/#scheduling-options-in-the-ui">Scheduling in the UI</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/scheduling/#adding-labels-in-rancher-compose">Scheduling in Rancher Compose</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/scheduling/#table-of-scheduling-labels">Table of Scheduling Labels</a></li>
                    </ul>
                </li>
                <li><a href="/docs/rancher/v1.6/en/cattle/upgrading/">Upgrading Services</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/internal-dns-service/">Internal DNS Service in Cattle Environments</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/external-dns-service/">External DNS Service</a></li>
                <li>
                    <a href="#">Rancher-Compose<i class="pull-right fa fa-angle-down"></i></a>
                    <ul>
                        <li><a href="/docs/rancher/v1.6/en/cattle/rancher-compose/">Rancher Compose</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/rancher-compose/commands/">Commands and Options</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/rancher-compose/environment-interpolation/">Environment Interpolation</a></li>
                        <li><a href="/docs/rancher/v1.6/en/cattle/rancher-compose/build/">Building with AWS S3</a></li>
                    </ul>
                </li>
                <li><a href="/docs/rancher/v1.6/en/cattle/secrets/">Secrets - Experimental</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/webhook-service/">Webhooks</a></li>
                <li><a href="/docs/rancher/v1.6/en/cattle/labels/">Labels in Cattle</a></li>
          </ul>
    </li>
    <li>
          <a href="#">Kubernetes<i class="pull-right fa fa-angle-down"></i></a>
          <ul>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/">Launching Kubernetes</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/resiliency-planes/">Resiliency Planes</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/providers/">Cloud Providers</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/private-registry/">Private Registry</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/rbac/">RBAC</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/disaster-recovery/">Disaster Recovery</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/backups/">Backups</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/storage/">Persistent Storage</a></li>
              <li>
                  <a href="#">Add-ons Support<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/addons/">Add-ons Support</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/addons/#helm">Helm</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/addons/#skydns">SkyDNS</a></li>
                  </ul>
              </li>
              <li>
                  <a href="#">Ingress Support and Options<i class="pull-right fa fa-angle-down"></i></a>
                  <ul>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/">Ingress Support</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#host-based-routing">Host Based Routing</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#path-based-routing">Path Based Routing</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#scale-and-other-port">Multiple Load Balancers and Selecting Ports</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#tls">Using TLS</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#blocking-http">Blocking HTTP</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#custom-haproxy">Custom HAProxy</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#scheduled-globally">Scheduling on all Hosts</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#host-scheduling">Scheduling on a specific Host</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#only-local">Targeting Only Containers on the Same Host</a></li>
                      <li><a href="/docs/rancher/v1.6/en/kubernetes/ingress/#prefer-local">Prioritizing Containers on the Same Host</a></li>
                  </ul>
              </li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/upgrading/">Upgrading Kubernetes</a></li>
              <li><a href="/docs/rancher/v1.6/en/kubernetes/deleting/">Deleting Kubernetes</a></li>

          </ul>
    </li>
    <li><a href="/docs/rancher/v1.6/en/mesos/">Mesos</a></li>
    <li><a href="/docs/rancher/v1.6/en/swarm/">Swarm - Experimental </a></li>
    <li><a href="/docs/rancher/v1.6/en/windows/">Windows - Experimental</a></li>
    <li><a href="/docs/rancher/v1.6/en/native-docker/">Using Native Docker CLI</a></li>
    <li>
            <a href="#">Rancher Catalog<i class="pull-right fa fa-angle-down"></i></a>
            <ul>
                <li><a href="/docs/rancher/v1.6/en/catalog/">Catalog</a></li>
                <li><a href="/docs/rancher/v1.6/en/catalog/private-catalog/">Creating Private Catalogs</a></li>
            </ul>
        </li>
    <li><a href="#">Rancher CLI<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
            <li><a href="/docs/rancher/v1.6/en/cli/">Rancher CLI</a></li>
            <li><a href="/docs/rancher/v1.6/en/cli/commands/">Commands and Options</a></li>
            <li><a href="/docs/rancher/v1.6/en/cli/variable-interpolation/">Variable Interpolation</a></li>
        </ul>
    </li>
    <li><a href="/docs/rancher/v1.6/en/api/v2-beta/">API Documentation</a></li>
    <li><a href="/docs/rancher/v1.6/en/contributing/">Contributing to Rancher</a></li>
    <li>
        <a href="#">FAQs<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
            <li><a href="/docs/rancher/v1.6/en/faqs/server/">FAQs about Rancher Server</a></li>
            <li><a href="/docs/rancher/v1.6/en/faqs/agents/">FAQs about Rancher Agents/Hosts</a></li>
            <li><a href="/docs/rancher/v1.6/en/faqs/troubleshooting/">Troubleshooting FAQS</a></li>
        </ul>
    </li>
    <li>
        <a href="#">Docs Archive<i class="pull-right fa fa-angle-down"></i></a>
        <ul>
            <li><a href="/docs/rancher/v1.5/en/">Rancher v1.5</a></li>
            <li><a href="/docs/rancher/v1.4/en/">Rancher v1.4</a></li>
            <li><a href="/docs/rancher/v1.3/en/">Rancher v1.3</a></li>
            <li><a href="/docs/rancher/v1.2/en/">Rancher v1.2</a></li>
            <li><a href="/docs/rancher/v1.1/en/">Rancher v1.1</a></li>
            <li><a href="/docs/rancher/v1.0/en/">Rancher v1.0</a></li>
        </ul>
    </li>
</ul>

      </div>

      <div class="col span-8">
        <div class="content-container">
          <h2 id="launching-rancher-server-with-no-internet-access">Launching Rancher Server with No Internet Access</h2>
<hr />

<p>Rancher Server is able to run without internet, but the web browser accessing the UI will need access to the private network. Rancher can be configured with either a private registry or with an HTTP proxy.</p>

<p>When launching Rancher server with no internet access, there will be a couple of features that will no longer work properly.</p>

<ul>
  <li>Launching Hosts using the UI for Cloud Providers - Since Rancher is calling Docker Machine to create hosts in the cloud providers, this functionality will not work. You will only be able to add <a href="/docs/rancher/v1.6/en/hosts/custom/">custom hosts</a> to your Rancher setup.</li>
  <li>Github Authentication</li>
</ul>

<h3 id="requirements">Requirements</h3>

<p>Review the Rancher server <a href="/docs/rancher/v1.6/en/installing-rancher/installing-server/#requirements">requirements</a>.</p>

<h3 id="rancher-server-tags">Rancher Server Tags</h3>

<p>Rancher server has 2 different tags. For each major release tag, we will provide documentation for the specific version.</p>

<ul>
  <li><code class="highlighter-rouge">rancher/server:latest</code> tag will be our latest development builds. These builds will have been validated through our CI automation framework. These releases are not meant for deployment in production.</li>
  <li><code class="highlighter-rouge">rancher/server:stable</code> tag will be our latest stable release builds. This tag is the version that we recommend for production.</li>
</ul>

<p>Please do not use any release with a <code class="highlighter-rouge">rc{n}</code> suffix. These <code class="highlighter-rouge">rc</code> builds are meant for the Rancher team to test out builds.</p>

<h3 id="using-a-private-registry">Using A Private Registry</h3>

<p>It is assumed you either have your own private registry or other means of distributing docker images to your machine. If you need help with creating a private registry, please refer to the <a href="https://docs.docker.com/registry/">Docker documentation for private registries</a>.</p>

<h4 id="pushing-images-to-private-registry">Pushing Images to Private Registry</h4>

<p>It is <strong>very important</strong> that all images (e.g.. <code class="highlighter-rouge">rancher/server</code>, <code class="highlighter-rouge">rancher/agent</code>, and any <a href="/docs/rancher/v1.6/en/rancher-services/">infrastructure service</a> images) are distributed before attempting to install/upgrade Rancher Server. If these versions are not available in your private registry, Rancher Server will become unstable.</p>

<p>For each release of Rancher server, the corresponding Rancher agent and Rancher agent instance versions will be available in the release notes. In order to find the images for your infrastructure services, you would need to reference the <code class="highlighter-rouge">infra-templates</code> folders in our <a href="https://github.com/rancher/rancher-catalog">Rancher catalog</a> and <a href="https://github.com/rancher/community-catalog">community catalog</a> to see which infrastructure services that you’d like to include and the associated images in those templates from those <a href="/docs/rancher/v1.6/en/catalog/">catalogs</a>.</p>

<h5 id="commands-to-push-images-to-private-registry">Commands to Push Images to Private Registry</h5>

<p>These examples are for the <code class="highlighter-rouge">rancher/server</code> and <code class="highlighter-rouge">rancher/agent</code> images using a machine that has access to both DockerHub and your private registry. We recommend tagging the version of the images in your private registry as the same version that exist in DockerHub.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># rancher/server</span>
<span class="gp">$ </span>docker pull rancher/server:v1.6.0
<span class="gp">$ </span>docker tag rancher/server:v1.6.0 localhost:5000/&lt;NAME_OF_LOCAL_RANCHER_SERVER_IMAGE&gt;:v1.6.0
<span class="gp">$ </span>docker push localhost:5000/&lt;NAME_OF_LOCAL_RANCHER_SERVER_IMAGE&gt;:v1.6.0

<span class="c"># rancher/agent</span>
<span class="gp">$ </span>docker pull rancher/agent:v1.1.3
<span class="gp">$ </span>docker tag rancher/agent:v1.1.3 localhost:5000/&lt;NAME_OF_LOCAL_RANCHER_AGENT_IMAGE&gt;:v1.1.3
<span class="gp">$ </span>docker push localhost:5000/&lt;NAME_OF_LOCAL_RANCHER_AGENT_IMAGE&gt;:v1.1.3
</code></pre>
</div>

<p><br /></p>

<blockquote>
  <p><strong>Note:</strong> For any infrastructure services images, you would have to follow the same steps.</p>
</blockquote>

<h4 id="launching-rancher-server-with-private-registry">Launching Rancher Server with Private Registry</h4>

<p>On your machine, start Rancher server to use the specific Rancher Agent image. We recommend using specific version tags instead of the <code class="highlighter-rouge">latest</code> tag to ensure you are working with the correct versions.</p>

<p>Example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo docker run -d --restart<span class="o">=</span>unless-stopped -p 8080:8080 <span class="se">\</span>
    -e <span class="nv">CATTLE_BOOTSTRAP_REQUIRED_IMAGE</span><span class="o">=</span>&lt;Private_Registry_Domain&gt;:5000/&lt;NAME_OF_LOCAL_RANCHER_AGENT_IMAGE&gt;:v1.1.3 <span class="se">\</span>
    &lt;Private_Registry_Domain&gt;:5000/&lt;NAME_OF_LOCAL_RANCHER_SERVER_IMAGE&gt;:v1.6.0
</code></pre>
</div>

<h4 id="rancher-ui">Rancher UI</h4>

<p>The UI and API will be available on the exposed port <code class="highlighter-rouge">8080</code>. You can access the UI by going to the following URL: <code class="highlighter-rouge">http://&lt;SERVER_IP&gt;:8080</code>.</p>

<h4 id="adding-hosts">Adding Hosts</h4>

<p>After accessing the UI, click on the <strong>Add Host</strong> button. This will immediately bring you to the <strong>Host Registration</strong> page. Click <strong>Save</strong>.</p>

<p>The cloud providers will not work as Rancher uses Docker Machine to provision the hosts through the cloud providers. Click on the <strong>Custom</strong> icon to add the host.</p>

<p>The command from the UI will be configured to use the private registry image for the Rancher agent.</p>

<h5 id="example-add-custom-host-command">Example Add Custom Host Command</h5>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo docker run -d --privileged -v /var/run/docker.sock:/var/run/docker.sock &lt;Private_Registry_Domain&gt;:5000/&lt;NAME_OF_LOCAL_RANCHER_AGENT_IMAGE&gt;:v1.1.3 http://&lt;SERVER_IP&gt;:8080/v1/scripts/&lt;security_credentials&gt;
</code></pre>
</div>

<h4 id="configuring-the-default-registry-for-infrastructure-stacks">Configuring the Default Registry for Infrastructure Stacks</h4>

<p>In Rancher, all <a href="/docs/rancher/v1.6/en/rancher-services/">infrastructure services</a> are defaulted to pull from DockerHub. Changing the default registry from DockerHub to a different private registry is located in the API settings.</p>

<ul>
  <li>
    <p><strong>Add the private registry:</strong> In <strong>Infrastructure</strong> -&gt; <strong>Registries</strong> section, add the private registry that contain the images for the infrastructure services.</p>
  </li>
  <li>
    <p><strong>Update the default registry:</strong> Under <strong>Admin</strong> -&gt; <strong>Setting</strong> -&gt; <strong>Advanced Settings</strong>, click on the <strong>I understand that I can break things by changing advanced settings</strong>. Find the <strong>registry.default</strong> setting and click on the edit icon. Add the registry value and click on <strong>Save</strong>. Once the <code class="highlighter-rouge">registry.default</code> setting has been updated, the infrastructure services will begin to pull from the private registry instead of DockerHub.</p>
  </li>
  <li>
    <p><strong>Create a New Environment:</strong> After updating the default registry, you will need to re-create your environments so that the infrastructure services will be using the updated default registry. Any existing environments prior to the change in default registry would have their infrastructure services still pointing to DockerHub.</p>
  </li>
</ul>

<blockquote>
  <p><strong>Note:</strong> Any infrastructure stacks in an existing environment will still be using the original default registry (e.g. DockerHub). These stacks will need to be deleted and re-launched to start using the updated default registry. The stacks can be deployed from <strong>Catalog</strong> -&gt; <strong>Library</strong>.</p>
</blockquote>

<h3 id="using-an-http-proxy">Using an HTTP Proxy</h3>

<p>Reminder, in this setup, the web browser accessing the UI will need access only the private network.</p>

<h4 id="configuring-docker-to-use-an-http-proxy">Configuring Docker to use an HTTP Proxy</h4>

<p>In order to set up an HTTP proxy, the Docker daemon will need to be modified to point to the proxy for Rancher server and Rancher hosts. Before launching Rancher server or Rancher agents, edit the <code class="highlighter-rouge">/etc/default/docker</code> file to point to your proxy and restart Docker.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo vi /etc/default/docker
</code></pre>
</div>

<p>In the file, edit the <code class="highlighter-rouge">#export http_proxy="http://127.0.0.1:3128/"</code> to have it point to your proxy. Save your changes and then restart docker. Restarting Docker is different on every OS.</p>

<blockquote>
  <p><strong>Note:</strong> If you are running Docker with systemd, please follow Docker’s <a href="https://docs.docker.com/articles/systemd/#http-proxy">instructions</a> on how to configure the HTTP proxy.</p>
</blockquote>

<h4 id="launching-rancher-server">Launching Rancher Server</h4>

<p>Rancher server does not need to be launched using any environment variables when using a proxy. Therefore, the command to start Rancher server will be the same as a regular installation.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo docker run -d --restart<span class="o">=</span>unless-stopped -p 8080:8080 rancher/server
</code></pre>
</div>

<h4 id="rancher-ui-1">Rancher UI</h4>

<p>The UI and API will be available on the exposed port <code class="highlighter-rouge">8080</code>. You can access the UI by going to the following URL: <code class="highlighter-rouge">http://&lt;SERVER_IP&gt;:8080</code>.</p>

<h4 id="adding-hosts-1">Adding Hosts</h4>

<p>After accessing the UI, you can click on the <strong>Add Host</strong> button. This will immediately bring you to the <strong>Host Registration</strong> page. Click <strong>Save</strong>.</p>

<p>The cloud providers will not work as Rancher uses <code class="highlighter-rouge">docker-machine</code> to provision the hosts through the cloud providers. Click on the <strong>Custom</strong> icon to add the host.</p>

<p>The command from the UI can be used on any machine that has Docker configured to use HTTP proxy.</p>


          <footer class="clearfix">
            <div class="copyright pull-left">Copyright &copy; 2014-2017 <a href="http://rancher.com">Rancher Labs</a>.  All Rights Reserved.</div>
            <a class="btn btn-primary pull-right" href="https://github.com/rancher/rancher.github.io/tree/master/rancher/v1.6/en/installing-rancher/installing-server/no-internet-access/index.md">Edit this page <i class="fa fa-pencil"></i></a>
          </footer>
        </div>
      </div>
    </div>

    <script src="/docs/vendor/jquery.js?t=2017-09-13 18:12:52 -0700"></script>
    <script src="/docs/js/jquery.slicknav.min.js?t=2017-09-13 18:12:52 -0700"></script>
    <script src="/docs/js/rancher-docs.js?t=2017-09-13 18:12:52 -0700"></script>

    <!-- Start of Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-56382716-3', 'auto');
        ga('send', 'pageview');
    </script>
    <!-- End of Google Analytics -->

    <!-- Start of Async HubSpot Analytics Code -->
    <script type="text/javascript">
    (function(d,s,i,r) {
    if (d.getElementById(i)){return;}
    var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
    n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/468859.js';
    e.parentNode.insertBefore(n, e);
    })(document,"script","hs-analytics",300000);
    </script>
    <!-- End of Async HubSpot Analytics Code -->
  </body>
</html>

